<Key@ButtonBehavior+Image>:
    on_kv_post: self.source = f"misc/{self.name}.png"
    on_press: self.source = "misc/keydown.png"
    on_release:
        self.source = f"misc/{self.name}.png"
        app.root.get_screen("game_screen").handle_key(self)

<Lamp@Widget>:
    _color:  [1, 1, 1]
    canvas:
        Color:
            rgb: self._color
        Ellipse:
            size: self.size
            pos: self.pos
    size_hint_x: 0.2

<LampBoard@GridLayout>:
    padding: dp(10)
    spacing: dp(10)
    size_hint_y: 0.7
    canvas:
        Color:
            rgba: 16 / 255, 16 / 255, 16 / 255, 1
        RoundedRectangle:
            size: root.size
            pos: root.pos
    cols: 2

    Lamp:
        id: lamp
    TextInput:
        id: board_input
        multiline: False
        on_text:
            if self.text != self.text.upper(): self.text = self.text.upper()

<Keyboard@GridLayout>:
    canvas:
        Color:
            rgba: 51 / 255, 51 / 255, 51 / 255, 1
        Rectangle:
            size: root.size
            pos: root.pos
    rows: 3

    BoxLayout:
        spacing: dp(10)
        padding: dp(15)
        canvas:
            Color:
                rgba: 16 / 255, 16 / 255, 16 / 255, 1
            Line:
                rectangle: self.x, self.y, self.width, self.height
                width: 5
        Widget:
        Key:
            id: Q
            name: "Q"
        Key:
            id: W
            name: "W"
        Key:
            id: E
            name: "E"
        Key:
            id: R
            name: "R"
        Key:
            id: T
            name: "T"
        Key:
            id: Z
            name: "Z"
        Key:
            id: U
            name: "U"
        Key:
            id: I
            name: "I"
        Key:
            id: O
            name: "O"

    BoxLayout:
        spacing: dp(10)
        padding: dp(10)
        canvas:
            Color:
                rgba: 16 / 255, 16 / 255, 16 / 255, 1
            Line:
                rectangle: self.x, self.y, self.width, self.height
                width: 4
        Widget:
        Key:
            id: A
            name: "A"
        Key:
            id: S
            name: "S"
        Key:
            id: D
            name: "D"
        Key:
            id: F
            name: "F"
        Key:
            id: G
            name: "G"
        Key:
            id: H
            name: "H"
        Key:
            id: J
            name: "J"
        Key:
            id: K
            name: "K"
        Widget:

    BoxLayout:
        spacing: dp(10)
        padding: dp(10)
        canvas:
            Color:
                rgba: 16 / 255, 16 / 255, 16 / 255, 1
            Line:
                rectangle: self.x, self.y, self.width, self.height
                width: 2
        Key:
            id: P
            name: "P"
        Key:
            id: Y
            name: "Y"
        Key:
            id: X
            name: "X"
        Key:
            id: C
            name: "C"
        Key:
            id: V
            name: "V"
        Key:
            id: B
            name: "B"
        Key:
            id: N
            name: "N"
        Key:
            id: M
            name: "M"
        Key:
            id: L
            name: "L"

<EnigmaKeyboard@BoxLayout>:
    canvas:
        Color:
            rgb: 0, 0, 0

    orientation: "vertical"
    LampBoard:
        id: lamp_board
    Keyboard:
        id: keyboard
